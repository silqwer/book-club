스코프와 중첩 스코프 사이에 맺어진 연결을 스코프 체인이라고 하는데 변수 접근 시 사용할 경로가 스코프 체인을 통해 결정된다. 이대 체인은 변수 탐색 경로가 위 혹은 바깥으로만 향하도록 지시받습니다.

# 3.1 탐색의 진실

변수가 어떤 스코프에서 왔는지 알려주는 메타 정보는 보통 컴파일 과정 초기에 결정된다. 렉시컬 스코프는 컴파일 초기에 확정되므로 구슬 색은 런타임 상황에 영향을 받지 않는다.

런타임에 탐색을 할 필요가 없다는 점은 최적화 관점에서 렉시컬 프코프가 가져다주는 중요한 혜택이다. 변수 탐색에 시간을 쓰지 않아도 되기 때문에 런타임은 좀 더 효율적으로 작동할 수 있다.

컴파일 중에 구슬 색이 결정되지 않는 경우는?

- 선언하지 않은 변수에 대한 참조는 해당 파일을 컴파일하는 동안에는 색이 지정되지 않는다.
- 탐색이 지연되는 경우는 결국 변수가 발견되는 범위(주로 전역 스코프)를 기준으로 색이 정해진다.

# 3.2 변수 섀도잉

렉시컬 스코프에 해당하는 양동이를 분류하는 게 중요해지는 시점은 두 개 이상의 변수가 있고, 각 변수들이 속한 스코프는 다르지만 이름이 같은 경우이다. 복수 참조가 발생하면 변수가 하나만 있는 것처럼 처리된다.

이러한 이유로 이름이 같은 변수를 꼭 두 개 이상 사용해야 한다면 스코프를 반드리 분리(중첩 스코프등) 해야한다.

```tsx
var studentName = "Jimin";

function printStudent(studentName) {
  studentName = studentName.toUpperCase();
  console.log(studentName);
}

printStudent("Bora"); // 출력: BORA

printStudent(studentName); // JIMIN

console.log(studentName); // JIMIN
```

렉시컬 스코프의 주요 특징을 섀도잉이라고 한다. 매개변수가 전역 변수를 가려버리는 꼴이 된 거다. `매개변수가 전역 변수를 그늘로 가리고 있다` 는 문장에서 그늘진 이라는 용어를 확실히 이해해야한다.

→ 섀도잉이 된다고 해도 나는 가독성이 안 좋기 때문에 이렇게 작성하지는 않을 것이다.

## 3.2.1 전역 언섀도잉

코드를 읽게 될 사람을 혼란에 빠트려 버그를 만들 확률을 높이기 때문에 조심해야한다.

전역 객체는 본질적으로 전역 스코프를 객체로 나타낸 것이라 볼 수 있다.

그늘을 만든 변수가 있는 스코프에서 그늘로 가려진 변수에 접근할 수 있는 방법은 바로 이렇게 전역 객체를 통하는 방법뿐이다.

## 3.2.2 복사는 접근과 다릅니다

참조 복사본을 통해 객체의 내용을 수정하는 건 렉시컬 환경을 고려해 변수 자체에 접근하는 게 아니기 때문이다.

## 3.2.3 금지된 섀도잉

let은 var를 가릴 수 있지만 var는 let을 가릴 수 없다. → 가린다는 접근이 새롭다.

SyntaxError가 발생한 진짜 이유는 var가 같은 이름을 사용해 let으로 선언한 변수의 경계를 가로지르려고 했기 때문이다. 이는 허용되지 않는 행위이다.

내부 스코프에 있는 let은 외부 스코프에 있는 var를 언제나 가릴 수 있다. 내부 스코프에 있는 var는 둘 사이에 함수 경계가 있는 경우에만 외부 스코프에 있는 let을 가릴 수 있다.

# 3.3 함수 이름 스코프

함수표현식이기 때문에 함수 자체가 호이스팅 되지 않는다.

함수 선언문과 함수 표현식의 두드러지는 차이점은 함수 이름 식별자 작동 방식이다.

이름 식별자가 있는 함수 표현식은 `기명 함수 표현식`이라고 부른다. 없는 경우는 `익명 함수 표현식`이라고 한다. 익명 함수 표현식은 보다시피 스코프에 영향을 미치는 이름 식별자가 없다.

## 3.4 화살표 함수

ES6에서 도입

화살표 함수는 렉시컬 스코프 관점에서 익명으로 취급된다. 화살표 함수는 함수를 참조하는 연관 식별자와 직접 연결되어 있지 않는다.

화살표 함수는 개발자에 다양한 형태나 조건에 대한 유추를 비용으로 떠넘기면서 그 간결성을 유지합니다.

화살표 함수는 익명이라는 특성 이외에는 function을 사용해 선언한 함수와 동일한 렉시컬 프코프 규칙을 적용받는다.

# 3.5 정리

선언을 하든 표현식을 쓰든, 함수를 정의하면 새로운 스코프가 만들어진다.

스코프 중첩을 어떻게 만들었는지에 따라 스코프 계층 관계가 만들어지는데, 이를 스코프 체인이라 부른다.

스코프 체인은 변수를 위 혹은 바깥쪽 방향으로만 접근 가능하도록 통제한다.
