# Topic 8 좋은 설계의 핵심

`Tip 14` 좋은 설계는 나쁜 설계보다 바꾸기 쉽다.

잘 설계되었다는 건 사용하는 사람에게 적응하여 맞춰진다는 의미이다. 잘 설계된 코드는 바뀜으로써 사용하는 사람에게 맞춰져야 한다.

그래서 우리는 ETC 원칙을 따른다. Easier to Change

- 결합도를 줄이면 → 관심사를 분리함으로써 각각이 바꾸기 쉬워진다.
- 단일 책임 원칙 → 요구 사항이 바뀌더라도 모듈 하나만 바꿔서 반영할 수 있다.
- 좋은 이름 → 이름이 좋으면 코드가 읽기 쉬워지고, 코드를 바꾸려면 코드를 읽어야 한다.

## ETC는 규칙이 아니라 가치

가치는 결정을 내리게 도움을 주는 것이다. 결정을 돕는다. ETC는 선택의 갈림길에서 도움을 주는 안내자다.

스스로에게 `내가 방금 한 일이 전체 시스템을 바꾸기 쉽게 만들었을까?, 어렵게 만들었을까?` 질문하라

ETC에는 암묵적인 전제가 있다. 바로 여러 길 중 어떤 길이 미래의 변경을 쉽게 만드는지 알 수 있다는 것이다.

실마리가 보이지 않을 때 아래 두 가지를 해라.

1. 앞으로 어떤 모습으로 바뀔지 잘 모르겠을 때 언제건 궁긍의 `바꾸기 쉽게`라는 길을 선택한다. 코드의 결합도를 낮추고 응집도를 높이라는 이야기다.
2. 직관을 발전시키는 기회로 삼아라. 엔지니어링 일지에 현재 상황과 나의 선택, 그리고 변경 사항에 대한 추측을 정리해 둬라. 그리고 코드에 표시를 남겨라. 다음에 코드를 변경할 시점이 왔을 때 뒤를 돌아보고 자신에게 피드백을 줄 수 있다.

# Topic 9 DRY: 중복의 해악

프로그래머는 늘 유지 보수 모드에 있다.

소프트웨어를 신뢰성 높게 개발하는 유일한 길, 개발을 이해하고 유지 보수하기 쉽게 만드는 유일한 길은 우리가 DRY라 부르는 원칠을 따르는 것이다.

모든 지식은 시스템 내에서 단 한 번만, 애매하지 않고, 권이 있게 표현되어야 한다.

`Tip 15` DRY: 반복하지 말라

DRY를 따르지 않으면 똑같은 것이 두 군데 이상에 표현될 것이다. DRY가 실용주의 프로그래머의 도구 상자에서 가장 중요한 도구 중 하나이다.

## DRY는 코드 밖에서도

### 코드의 중복

## 모든 코드 중복이 지식의 중복은 아니다

코드는 동일하지만, 두 함수가 표현하는 지식이 다르면 중복이 아니라 우연으로 볼 수 있다.

## 문서화 중복

코드에 주석을 달면 문서화 중복이 될 수 있다. 함수 이름이 명확하면 주석을 작성해 문서를 중복으로 작성할 필요가 없다.

## 데이터의 DRY 위반

가능하다면 언제나 객체의 속성을 읽고 쓸 때 접근자 함수를 사용하라.

접근자 함수의 사용은 단일 접근 원칙과 연관이 있다.

## 표현상의 중복

코드는 바깥세상과 연결될 때마다 일종의 DRY 위반을 하게 된다.

### 내부 API에서 생기는 중복

언어나 기술에 중립적인 형식으로 내부 API를 정의할 수 있는 도구를 찾아보라.

### 외부 API에서 생기는 중복

### 데이터 저장소와의 중복

많은 데이터 저장소가 데이터 스키마 분석 기능을 제공한다. 이런 기능을 이용하면 데이터 저장소와 코드 간의 중복을 많이 제거할 수 있다.

## 개발자 간의 중복

발견하거나 없애기 가장 어려운 유형의 중복은 같은 프로젝트에서 일하는 개발자들 사이에서 발생한다.

개발자 간의 중복에 대처하려면 크게는 의사소통을 잘하는 튼튼하고 유대가 돈독한 팀을 만들어야 한다.

최선책은 개발자 간에 적극적이고 빈번한 소통을 장려하는 것이다.

- 일일 스크럼 스탠드업 미팅
- 슬랙 채널
- 프로젝트 사서 도입
- 코드 리뷰

`Tip 16` 재사용하기 쉽게 만들어라.

사람들은 쉽지 않으면 하지 않을 것이다.

# Topic 10 직교성

직교성은 설계와 빌드, 테스트, 확장이 쉬운 시스템을 만드는데 있어 매우 중요한 개념이다.

## 직교성이란

결합도 줄이기를 의미한다.

잘 설계된 시스템에서는 데이터베이스 코드가 사용자 인터페이스와 서로 직교할 것이다.

### 비 직교적인 시스템

헬리콥터 조정은 단연코 비 직교적이다.

## 직교성의 장점

`Tip 17` 관련 없는 것들 간에 서로 영향이 없도록 하라.

우리가 설계하고 싶은 것은 자족적인 컴포넌트, 즉 단일하고 잘 정의된 목적을 가진 독립적인 컴포넌트다. 응집이라고 부른다.

직교적인 시스템을 잘 작성하면 두 가지 큰 장점이 있다.

1. 생산성 향상
   1. 개발 시간과 테스트 시간이 줄어든다.
   2. 재사용도 촉진한다.
   3. 시스템이 더 느슨하게 결합되어 있을수록 재조합하고 개량하기 쉽다.
2. 리스트 감소
   1. 위험의 크기를 감소시켜 준다.
   2. 시스템이 잘 깨지지 않는다.
   3. 많은 테스트를 할 수 있다.

## 설계

모듈식, 컴포넌트 기반, 계층이라는 이름으로 직교적이라는 것을 설명한다.

계층 구조는 직교적 시스템을 설계하는 강력한 방법이다.

컴포넌트를 나누었을 때 다음과 같이 스스로에게 물어보라. `특정 기능에 대한 요구 사항을 대폭 변경하는 경우 몇 개의 모듈이 영향을 받는가?` 직교적인 시스템에서는 이 답이 하나여야 한다.

현실 세계의 변화와 설계 사이의 결합도를 얼마나 줄였는지도 확인해 보기 바란다.

자신의 힘으로 제어할 수 없는 속성에 의존하지 말라.

## 툴킷과 라이브러리

외부에서 만든 툴킷이나 라이브러리를 도입할 때 시스템의 직교성을 해치지 않는지 주의 깊게 살펴보기 바란다. 기술을 현명하게 선택하라.

→ SCM에서 관련 라이브러리가 버전 업이 되면서 빌드가 깨지는 케이스가 있었다.

## 코딩

직교성을 유지하기 위해 사용할 수 있는 몇 가지 기법이 있다.

### 코드의 결합도를 줄여라

부끄럼쟁이 코드를 작성하라. 즉, 불필요한 것은 다른 모듈에 보여 주지 않으며, 다른 모듈의 구현에 의존하지 않는 코드를 작성하라.

### 전역 데이터를 피하라

코드가 전역 데이터를 참조할 때마다 코드는 해당 데이터를 공유하는 다른 컴포넌트와 묶이게 된다.

일반적으로 필요한 컨텍스트를 모듈에 명시적으로 넘겨주면 코드를 이해하고 유지 보수하기 쉬워진다.

### 유사한 함수를 피하라.

전략 패턴을 사용할 수 있는지 고민해라.

자신이 작성하는 코드를 항상 비판적으로 바라보는 습관을 길러라.

코드의 구조와 직교성을 개선하기 위해 노력하라.

## 테스트

직교적으로 설계하고 구현한 시스템은 테스트하기 더 쉽다.

테스트를 정규 빌드 과정의 일부로 수행하는 것을 추천한다.

단위 테스트를 작성하는 행위 자체가 직교성을 테스트해 볼 수 있는 기회다.

테스트를 마친 뒤 코드를 병합할 때 버그 수정에 대한 태그를 붙여라.

이렇게 하면 버그 수정마다 수정한 소스 파일 개수를 수집하여 그 경향을 분석한 월 단위 리포트를 만들 수 있을 것이다.

### 문서화

놀랍게도 직교성은 문서에도 적용할 수 있다.

### 직교적으로 살아가기

DRY 원칙은 시스템 내부의 중복을 최소화하고, 직교성은 시스템 컴포넌트 간의 상호 의존도를 줄인다.

DRY 원칙으로 무장하고 직교성 원칙을 충실히 적용한다면 개발하고 있는 시스템이 더 유연하고 이해하기 쉬워질 것이다.

디버깅, 테스트, 유지 보수 또한 쉬워질 것이다. 리펙터링을 할 시간이다.

# Topic 11 가역성

당신이 가진 생각이 딱 하나밖에 없다면, 그것만큼 위험한 것은 없다.

엔지니어는 문제를 풀 때 단순한 하나의 해결책을 좋아한다.

그 사실 역시 언젠가는 변할 것이 뻔하다.

올바르게 추상화하여 영속성을 하나의 서비스로 제공하도록 만들었다면 달리는 도중에 말을 갈아탈 수 있는 유연성이 생길 것이다.

결정이 바뀌지 않을 것이라 가정하고서 발생할지도 모를 우연한 사건에 대비하지 않는 데에서 실수가 나온다.

결정이 돌에 새겨진 것이 아니라 바닷가의 모래 위에 쓰인 글씨라 생각하라.

`Tip 18` 최종 결정이란 없다.

## 유연한 아키텍처

많은 사람들이 코드를 유연하게 유지하려고 노력한다.

여러분이 할 수 있는 것은 바꾸기 쉽게 만드는 것이다.

`Tip 19` 유행을 좇지 말라.

# Topic 12 예광탄

실제 상황에서의 실시간 피드백이기 때문에 매우 실용적이다.

→ 사용자의 피드백을 받아서 바로바로 개선해 나간다.

## 어둠 속에서 빛을 내는 코드

즉각적인 피드백을 얻을 수 있다.

코딩에서 동일한 효과를 얻으려면 요구 사항으로부터 최종 시스템의 일부 측면까지 빨리, 눈에 보이게, 반복적으로 도달해야 한다.

시스템을 정의하는 중요한 요구 사항을 찾아라.

의문이 드는 부분이나 가장 위험이 커 보이는 곳을 찾아라.

이런 부분의 코드를 가장 먼저 작성하도록 개발 우선순위를 정하라

`Tip 20` 목표물을 찾기 위해 예광탄을 써라.

예광탄 코드는 한 번 쓰고 버리려고 만드는 것이 아니다. 앞으로도 계속 사용할 코드다. 예광탄 코드도 다른 제품 코드와 마찬가지로 오류 검사, 올바른 구조, 문서화, 자체 검사를 갖추어야 한다.

예광탄 개발 방법은 `프로젝트는 결코 끝나지 않는다.` 는 견해와도 일맥상통한다.

### 예광탄 코드 접근 방식의 장점

1. 사용자가 뭔가 작동하는 것을 일찍부터 보게 된다.
2. 개발자가 들어가서 일할 수 있는 구조를 얻는다.
3. 통합 작업을 수행할 기반이 생긴다
4. 보여줄 것이 생긴다.
5. 진행 상황에 대해 더 정확하게 감을 잡을 수 있다.

## 예광탄이 언제나 목표물을 맞추는 것은 아니다.

그럴 경우 목표물에 맞을 때까지 조준을 옮겨야 한다. 이것이 핵심이다.

코드의 크기가 작으면 관성 역시 약하므로 빠르고 쉽게 바꿀 수 있다.

## 예광탄 코드 대 프로토타이핑

프로토타입은 어떤 개념을 실험해 보느라 대충 끼워 맞추어 구현한 것이므로 모두 버려야 한다. 그리고 교훈을 바탕으로 코드를 새로 작성한다.

예광탄 코드가 완성되었을 때 여러분은 시스템이 앞으로도 그 방식 그대로 동작하리라는 점을 안다.

프로토타입은 나중에 버리는 코드를 만든다. 예광탄 코드는 기능은 별로 없지만 완결된 코드이며, 최종 시스템 골격 중 일부가 된다. 프로토타입은 예광탄을 발사하기 전에 먼저 수행하는 정찰이나 정보 수집과 같은 것이다.

# Topic 13 프로토타입과 포스트잇

프로토타입은 실제 제품보다 훨씬 저렴하게 만들 수 있다.

위험 요소를 분석하고 노출시킨 후, 이를 매우 저렴한 비용으로 바로 잡을 기회를 얻는 것이다.

프로토타입은 제한된 몇 가지 질문에 답하기 위한 것이므로 실제 제품보다 훨씬 적은 비용으로 빠르게 개발할 수 있다.

## 프로토타이핑 대상

1. 아키텍쳐
2. 기존 시스템에 추가할 새로운 기능
3. 외부 데이터의 구조 혹은 내용
4. 외부에서 가져온 도구나 컴포넌트
5. 성능 문제
6. 사용자 인터페이스 설계

`Tip 21` 프로토타이핑으로 학습하라. 프로토타이핑은 학습 경험이다.

## 프로토타입을 어떻게 사용할 것인가?

무시해도 좋은 세부 사항은 아래와 같다.

1. 정확성
2. 완전성
3. 안정성
4. 스타일

## 아키택처 프로토타이핑

예광탄과 달리 프로토타입 시스템의 모듈이 꼭 기능을 가져야 하는 것은 아니다.

목적은 전체적으로 시스템이 어떻게 동작할지에 대해 감을 잡는 것이다.

## 프로토타입 코드를 사용하지 않도록 하려면?

프로토타입을 코드로 만들 때는 시작하기 전에 항상 모든 사람에게 여러분이 폐기 처분할 코드를 작성하고 있다는 사실을 이해시켜야 한다.

코드는 폐기할 것이고, 불완전하며, 완성할 수 없다는 사실을 분명히 주시시켜야 한다.

겉으론 완벽해 보이는 프로토타입 시연을 보고 오해하기 쉽다.

# Topic 14 도메인 언어

`Tip 22` 문제 도메인에 가깝게 프로그래밍하라.

# Topic 15 추정

`Tip 23` 추정으로 놀람을 피하라.

## 얼마나 정확해야 충분히 정확한가?

기간을 추정할 때는 다음과 같은 단위를 사용하기를 추천한다.

| 기간      | 추정의 단위                             |
| --------- | --------------------------------------- |
| 1~15일    | 일                                      |
| 3~6주     | 주                                      |
| 8~20주    | 달                                      |
| 20주 이상 | 추정치를 말하기 전에 다시 한번 생각해라 |

전달하려는 정확도를 고려하여 답변의 단위를 선택하라.

## 추정치는 어디에서 나오는가?

그 일을 해본 사람에게 물어보라.

### 무엇을 묻고 있는지 이해하라

첫 단계는 상대방이 무엇을 붇고 있는지 이해하는 것이다.

정확도뿐 아니라 도메인에 존재하는 조건에 대해서도 감을 잡을 필요가 있다.

추정하기 전에 미리 어떤 조건이 있을지 생각하는 습관을 길러야 한다.

### 시스템의 모델을 만들어라

개략적인 모델을 만들어 보라.

모델을 만드는 것은 창의적이면서도 동시에 장기적으로 유용한 작업일 수 있다.

어느 수준까지 모델을 정교하게 만들어야 할지는 여러분의 경험이 이야기해 줄 것이다.

### 모델을 컴포넌트로 나눠라

다 만든 모델은 컴포넌트로 분해할 수 있다. 이제 이러한 컴포넌트들이 어떻게 사용 작용하는지를 수식으로 기술해야 한다.

### 각 매개 변수에 값을 할당하라

매개 변수를 찾아냈다면 이제 각 매개 변수에 값을 할당할 차례다.

### 답을 계산하라

### 여러분의 추정 실력을 기록하라

여러분이 계산한 추정치를 기록해 놓고 나중에 이 값이 실제 결과에 얼마나 가까웠는지를 평가해 보면 정말 좋을 것이다.

추정치가 틀렸더라도 움츠리거나 도망가지 말라. 왜 틀렸는지 찾아라

### 프로젝트 일정 추정하기

`Tip 24` 코드와 함께 일정도 반복하며 조정하라.
