## CHAPTER 03 코드에서 나는 악취

### 토론

악취의 종류가 이렇게 다양할 수 있는지 몰랐네요. 이 중에서 특별히 신경써서 관리하는 냄새는 어떤 것들이 있으신가요? 저는 중복 코드 악취가 제일 싫어요

### 3.1 기이한 이름

코드는 단순하고 명료하게 작성해야 한다. 함수, 모듈, 변수, 클래스 등의 이름만 봐도 무슨 일을 하고 어떻게 사용해야 하는지 명확히 할 수 있도록 신경써야한다.

- 함수 선언 바꾸기
- 변수 이름 바꾸기
- 필드 이름 바꾸기

→ 점심메뉴 고르기보다 어려운 것 같아요.

### 3.2 중복 코드

똑같은 코드를 하나로 통합하여 더 나은 프로그램을 만들 수 있다

- 함수 추출하기
- 문장 슬라이스하기
- 메서드 올리기

### 3.3 긴 함수

무엇을 하는지 (함수의 목적) 를 코드가 설명해주지 못할수록 함수로 뽑는게 유리하다

- 함수 추출하기
- 임시 변수를 질의 함수로 바꾸기
- 매개변수 객체 만들기
- 객체 통째로 넘기기
- 함수를 명령으로 바꾸기
- 조건문 분해하기
- 조건부 로직을 다형성으로 바꾸기
- 반복문 쪼개기

→ 저는 함수가 10~15줄을 넘지 않도록 신경쓰는 편입니다. 그래야 읽기 좋더라고요.

### 3.4 긴 매개변수 목록

매개변수 목록이 길어지면 그 자체로 이해하기 어려울 때가 많다

- 매개변수를 질의 함수로 바꾸기
- 객체 통째로 넘기기
- 매개변수 객체 만들기
- 플래그 인수 제거하기
- 여러 함수를 클래스로 묶기

### 3.5 전역 데이터

전역 데이터는 코드베이스 어디에서든 건드릴 수 있고 값을 누가 바꿨는지 찾아낼 메커니즘이 없다. 클래스 변수와 싱글톤도 같은 문제가 발생한다

- 변수 캡슐화하기

### 3.6 가변 데이터

함수형 프로그래밍 : 데이터는 절대 변하지 않고, 데이터를 변경하려면 반드시 변경하려는 값에 해당하는 복사본을 만들어서 반환한다

- 변수 캡슐화하기
- 변수 쪼개기
- 문장 슬라이드하기
- 함수 추출하기
- 질의 함수와 변경 함수 분리하기
- 세터 제거하기
- 파생 변수를 질의 함수로 바꾸기
- 여러 함수를 클래스로 묶기
- 여러 함수를 변환 함수로 묶기
- 참조를 값으로 바꾸기

### 3.7 뒤엉킨 변경

코드를 수정할 때는 시스템에서 고쳐야 할 딱 한군데를 찾아서 그 부분만 수정할 수 있어야한다. 뒤엉킨 변경은 단일 책임 원칙이 제대로 지켜지지 않을 때 나타난다.

- 단계 쪼개기
- 함수 옮기기
- 함수 추출하기
- 클래스 추출하기

### 3.8 산탄총 수술

코드를 변경할 때마다 자잘하게 수정해야 하는 클래스가 많을 때 풍긴다.

- 함수 옮기기
- 필드 옮기기
- 여러 함수를 클래스로 묶기
- 여러 함수를 변환 함수로 묶기
- 단계 쪼개기
- 함수 인라인하기
- 클래스 인라인하기

### 3.9 기능 편애

어떤 함수가 자기가 속한 모듈의 함수나 데이터보다 다른 모듈의 함수나 데이터와 상호작용 할 일이 더 많을 때 풍기는 냄새. 함께 변경할 대상을 한데 모으자

- 함수 옮기기
- 함수 추출하기
- Strategy Pattern, Visitor Pattern, Self-Delegation

→ Service Layer에서 여러 repository나 다른 service를 많이 참조할 때가 있는데 기능 편애에 해당하는 것일까요?

### 3.10 데이터 뭉치

데이터 항목 서너 개가 여러 곳에서 항상 함께 뭉쳐 다닌다면 뭉치는 보금자리를 따로 마련해줘야 한다. 데이터 뭉치인지 판별하려면 값을 하나 삭제했을 때, 나머지 데이터만으로 의미가 없다면 이 데이터들은 데이터 뭉치이다.

- 클래스 추출하기
- 매개변수 객체 만들기
- 객체 통째로 넘기기

### 3.11 기본형 집착

주어진 문제에 딱 맞는 기초 타입은 직접 정의하자

- 기본형을 객체로 바꾸기
- 타입 코드를 서브클래스로 바꾸기
- 조건부 로직을 다형성으로 바꾸기
- 클래스 추출하기
- 매개변수 객체 만들기

→ 당장 떠오르는 몇가지 예시가 있네요. 1000000000 이상의 값만 유효한 값으로 생각하는 id 값들이 있는데, 이런 것을 객체로 바꾸면 좋을 것 같아요.

### 3.12 반복되는 switch문

똑같은 조건부 로직이 여러 곳에서 반복해 등장하는 코드에 집중하자

- 조건부 로직을 다형성으로 바꾸기

### 3.13 반복문

- 반복문을 파이프라인으로 바꾸기

→ 성능의 이유로 파이프라인을 반복문으로 바꾸라는 분이 계셨는데, 이를 설득하는 것도 쉽지 않아보입니다.

### 3.14 성의 없는 요소

본문 코드를 그대로 쓰는 것고 다름없는 함수, 메서드가 하나뿐인 클래스 등 구조가 필요 없을 때는 고의 보내드리는 것이 좋다

- 함수 인라인하기
- 클래스 인라인하기
- 계층 합치기

### 3.15 추측성 일반화

나중에 필요할 거야 → 제거하자

- 계층 합치기
- 함수 인라인하기
- 클래스 인라인하기
- 함수 선언 바꾸기
- 죽은 코드 제거하기

### 3.16 임시 필드

특정 상황에서만 값이 설정되는 필드는 코드를 이해하기 어렵게 만든다

- 클래스 추출하기
- 함수 옮기기
- 특이 케이스 추가하기

→ 임시 필드가 하나만 있어도 이를 클래스로 추출하는 것이 옳은가요?

### 3.17 메시지 체인

한 객체를 통해 다른 객첼르 얻은 뒤 방금 얻은 객체에 또 다른 객체를 요청하는 것들

- 위임 숨기기
- 함수 추출하기
- 함수 옮기기

### 3.18 중개자

캡슐화에 위임이 지나치면 문제가 된다

- 중개자 제거하기
- 함수 인라인 하기

→ 잘 이해가 안가네요ㅠ 예시를 들어주실 수 있는 분 계실까요?

### 3.19 내부자 거래

모듈 간 데이터 교환이 많다면 결합도가 높기 때문에 이 양을 최소로 줄이고 투명하게 처리해야한다

- 함수 옮기기
- 필드 옮기기
- 위임 숨기기
- 서브클래스를 위임으로 바꾸기
- 슈퍼클래스를 위임으로 바꾸기

### 3.20 거대한 클래스

한 클래스가 너무 많은 일을 하려다 보면 필드 수가 상당히 늘어난다.

- 클래스 추출하기
- 슈퍼클래스 추출하기
- 타입 코드를 서브클래스로 바꾸기

### 3.21 서로 다른 인터페이스의 대안 클래스들

언제든 다른 클래스로 교체할 수 있도록 하자

- 함수 선언 바꾸기
- 함수 옮기기
- 슈퍼클래스 추출하기

### 3.22 데이터 클래스

- 레코드 캡슐화 하기
- 세터 제거하기
- 함수 옮기기
- 함수 추출하기
- 단계 쪼개기

### 3.23 상속 포기

부모의 유산을 원치 않거나 필요 없다면? 물려받지 않을 부모 코드를 보조리 새로 만든 서브클래스에 넘긴다. (**권하지 않는 방법임**)

- 매서드 내리기
- 필드 내리기

상속 포기 냄새는 서버클래스가 부모의 동작은 필요로 하지만 인터페이스는 따르고 싶지 않을 때 심하게 난다.

- 서브클래스를 위임으로 바꾸기
- 슈퍼클래스를 위임으로 바꾸기

### 3.24 주석

주석을 남겨야겠다는 생각이 들면, 가장 먼저 주석이 필요 없는 코드로 리팩터링 해본다

- 함수 추출하기
- 함수 선언 바꾸기
- 어서션 추가하기